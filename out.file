[globals] ;DEFINE AS VARIAVEIS GLOBAIS
TELEFONISTA=SIP/2001 ;DECLARA DE VARIAVEL
CLIENTE=5511958711770

[general] ;OPCOES GERAIS DO DIALPLAN
writeprotect=no ;MODO SOMENTE LEITURA
static=yes ;MODO ESTATICO

[astrid]
;ASTRID ATENDE E PERGUNTA O QUE O CLIENTE PRECISA
exten => 123,1,NoOp(CHAMADA ENTRANTE PARA ASTRIDVOICE)
;exten => 1148580333,n,agi(googletts.agi,"OLÃ me chamo Astrid, sou a atendente virtual do Astrocentro, no que posso ajudar?",pt-BR)
;exten => 123,n,agi(googletts.agi,"OlÃ¡ sou a Astrid, no que posso ajudar?",pt-BR)
;exten => 123,n,agi(asterisk-api/route.php,textToSpeech,"Olá, sou a Astrid, no que posso ajudar?")
exten => 123,n,agi(asterisk-api/route.php,callIntenction,"inicio")
exten => 123,n,Playback(${resposta})

;GRAVACAO DO QUE O CLIENTE VAI DIZER
exten => 123,n,Record(/tmp/${CALLERID(num)}.wav,2,15,q)
exten => 123,n,NoOP(VARIAVEL ORIGEM ANTES DE SETAR EH ${CALLERID(num)})
exten => 123,n,Set(pergunta=/tmp/${CALLERID(num)})
exten => 123,n,NoOp(VARIAVEL DEPOIS QUE SETOU ${pergunta})

;ENVIO DO AUDIO(PERGUNTA DO CLIENTE) PARA A ASTRID
;exten => 1148580333,n,Playback(${cliente})
;exten => 123,n,agi(googletts.agi,"Certo, Aguarde sÃ³ um momentinho que vou verificar",pt-BR)
;exten => 123,n,agi(envio.php,${pergunta},${CALLERID(num)}
exten => 123,n,agi(asterisk-api/route.php,textToSpeech,"Certo, Aguarde só um momentinho que vou verificar")
exten => 123,n,Playback(${resposta})

exten => 123,n,agi(asterisk-api/route.php,default,${pergunta},${CALLERID(num)})
exten => 123,n,NoOP(VOLTOU ESTA INFO DO ARQUIVO PHP ${resposta})
exten => 123,n,Playback(${resposta})

;PERGUNTAR SE O CONSEGUIMOS RESOLVER O PROBLEMA DO CLIENTE
;exten => 123,n,agi(googletts.agi,"Consegui tirar sua duvida, diga SIM ou NÃ",pt-BR)
exten => 123,n,agi(asterisk-api/route.php,textToSpeech,"Consegui tirar sua dúvida, diga SIM ou Não")
exten => 123,n,Playback(${resposta})
;exten => 123,n,agi(speech-recog.agi,pt-BR)
exten => 123,n,Record(/tmp/${CALLERID(num)}.wav,2,4,q)
exten => 123,n,Set(pergunta=/tmp/${CALLERID(num)})
exten => 123,n,agi(asterisk-api/route.php,speechToText,${pergunta},${CALLERID(num)})
exten => 123,n,NoOP( RESPOSTA:  ${resposta})

;TOMADA DE DECISAO PARA CONTINUAR COM ATENDIMENTO OU DESLIGAR
;exten => 123,n,GotoIf($[${utterance}=sim]?sim:nao)
exten => 123,n,GotoIf($[${resposta}=sim]?sim:nao)
;exten => 123,n(sim),agi(googletts.agi,"Fico muito feliz em ter ajudado, caso tenha novas duvidas nos contate, ficaremos felizes em atende-lo, forte ABRACO",pt-BR)
exten => 123,n(sim),agi(asterisk-api/route.php,textToSpeech,"Fico muito feliz em ter ajudado, caso tenha novas duvidas nos contate, ficaremos felizes em atende-lo, forte abraço")
exten => 123,n,Playback(${resposta})
exten => 123,n,HangUp()
;exten => 123,n(nao),agi(googletts.agi, "Entendi, vamos tentar de outra forma entao, me diga em poucas palavras o que vocÃª precisa",pt-BR)
exten => 123,n(nao),agi(asterisk-api/route.php,textToSpeech,"Entendi, vamos tentar de outra forma entao, me diga em poucas palavras o que vocÃª precis")
exten => 123,n,Playback(${resposta})
exten => 123,n,Goto(123,4)




;teste
exten => 234,1,agi(asterisk-api/route.php,textToSpeech,"Certo, Aguarde só um momentinho que vou verificar", "teste 2")
exten => 234,n,Playback(${resposta})







;APLICAÃ DO GOOGLE PARA TRADUÃ DE TEXTO PARA VOZ
exten => 9876,1,Answer()
exten => 9876,n,agi(googletts.agi,"This is a simple google text to speech test in english.",en)  ;;Tocar mensagem em Ingles
exten => 9876,n,agi(googletts.agi,"Esta es una simples prueba de llamada",es)  ;;Tocar mensagem em espanhol
exten => 9876,n,agi(googletts.agi,"Fazendo um teste de texto para fala em portugues",pt-BR) ;;Tocar mensagem em portugues

;;GOOGLE speech Recognition
exten => 543,1,Answer()
exten => 543,n,agi(speech-recog.agi,pt-BR,2)
exten => 543,n,Verbose(1,O TEXTO DITO E: ${utterance})
exten => 543,n,Verbose(1,A PROBABILIDADE DE ESTAR CORRETO E: ${confidence})
exten => 543,n,Hangup()

;TESTE DE GOTOIF COM OR
exten => 300,1,Answer()
exten => 300,n,agi(googletts.agi, "Oi, me diga sim ou nao",pt-BR)
exten => 300,n,agi(speech-recog.agi,pt-BR,2)
exten => 300,n,Verbose(1,O TEXTO DITO E: ${utterance})
exten => 300,n,Verbose(1,A PROBABILIDADE DE ESTAR CORRETO E: ${confidence})
;exten => 300,n,GotoIf($[${utterance}=sim]?sim:nao)
exten => 300,6,ExecIf($[${utterance}=nao]?Goto(nao))
exten => 300,7,ExecIf($[${utterance}=sim]?Goto(sim))
;exten => 300,n(sim),agi(googletts.agi,"Caiu na resposta do sim",pt-BR)
exten => 300,n(sim),agi(googletts.agi,"Caiu na resposta do sim",pt-BR)
exten => 300,n,HangUp()
;exten => 300,n(nao),agi(googletts.agi, "Caiu na resposta do nao",pt-BR)
exten => 300,n(nao),agi(googletts.agi, "Caiu na resposta do nao",pt-BR)
exten => 300,n,HangUp()


;teste 
;exten => 321,1,agi(teste.agi, /tmp/teste2.mp3)
exten => 321,1,Playback(/tmp/teste_leandro)


exten => 1180,1,Playback(marcelo2)

exten => 700,1,Wait(1)
exten => 700,n,AGI(/var/lib/asterisk/sounds/convert.sh,teste.mp3,marcelo)
;exten => 700,n,NoOP(VARIAVEL TEST eh ${test})
;exten => 700,n,NoOP(VARIAVEL TEST2 eh ${test2})
;exten => 700,n,Playback(${test})
exten => 700,n,Hangup

[ramais]
exten => _X.,1,Dial(SIP/${EXTEN},60,tT)
exten => _X.,n,HangUp()



